C
	PROGRAM CRS_STRSCAN
C
	IMPLICIT NONE
C
	INTEGER*4	POINT,PT,ET,SC,RCX,ACPOINT(6)
	INTEGER*4	INTCX(4),I,J,K,SCOUNT,SCAN(40)
	INTEGER*4	UFO_OPEN
	REAL*4		LL,HL,REALC
C
	EXTERNAL	UFO_OPEN
C
	COMMON/CRS_SCANTBL/SCAN
C
	OPEN(UNIT=1,NAME='ANA:CRSANAMOD.DAT',FORM='UNFORMATTED',
	1	ACCESS='DIRECT',STATUS='OLD',RECL=20,SHARED,
	1	RECORDTYPE='FIXED',USEROPEN=UFO_OPEN)
C
	SCOUNT=0
C
	DO 100 I=1,1000
		READ	(1,REC=I)PT,ET,SC,RCX,LL,HL,
	1		ACPOINT,INTCX,REALC
C
		J=I/32+1	!LOCATE SCAN TABLE LONGWORD
		K=MOD(I,32)	!LOCATE BIT IN LONGWORD
C
		IF (PT .NE. 0) THEN
			SCOUNT=SCOUNT+1
			SCAN(J)=JIBSET(SCAN(J),K)	!SET SCAN BIT
		ELSE
			SCAN(J)=JIBCLR(SCAN(J),K)	!RESET SCAN BIT
		END IF
100	CONTINUE
	CLOSE	(UNIT=1)
C
	CALL	EXIT
	END

