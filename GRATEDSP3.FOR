	PROGRAM 	GRATEDSP3
C
	IMPLICIT NONE
C
	INTEGER*4	LINE,I,J,K,L
	CHARACTER*4	CLEAR/' [2J'/
	CHARACTER*3	HOME/' [H'/
	REAL*4		SECONDS/5.0/
	REAL*4		NEWVAL(300),
	1		FORTIM(10),
	1		TOTL(256)
C
	INTEGER*4	CXSAVE(10)
C
	INTEGER*4	STAT,VKID,PBID,
	1		SMG$CREATE_PASTEBOARD,
	1		SMG$CREATE_VIRTUAL_KEYBOARD,
	1		SMG$ENABLE_UNSOLICITED_INPUT
	LOGICAL*4	DO_NEXT
C
	INTEGER*4	CONTRL(2)
	REAL*4		PRGLSP(2),
	1		LVLPRN(2),
	1		LVOBAS(2),
	1		LVLOUT(2),
	1		SPDSET(2),
	1		SPDPRN(2),
	1		OUTBAS(2),
	1		OUTPUT(2),
	1		SPDO32(2),
	1		LTPH(2),
	1		LVSPI(2),
	1		LVSPD(2),
	1		LVSPP(2),
	1		SPOUTI(2),
	1		SPOUTD(2),
	1		SPOUTP(2),
	1		LVLHI(2),
	1		LVLLO(2),
	1		SPDHI(2),
	1		SPDLO(2),
	1		CNTLSP(2),
	1		CRTLSP(2),
	1		LVLPRO(2),
	1		SPDPRO(2),
	1		SPDS32(2),
	1		SPDN32(2),
	1		SPDL32(2),
	1		SPDB32(2),
	1		OUT32I(2),
	1		OUT32D(2),
	1		OUT32P(2),
	1		SP32LO(2),
	1		SP32HI(2)
C
	COMMON/DO_NEXT/DO_NEXT
	COMMON/GRATETBL3/NEWVAL,TOTL,FORTIM,CXSAVE
	COMMON/GRATEFILE3/CONTRL,PRGLSP,LVLPRN,LVOBAS,
	1		 LVLOUT,SPDSET,SPDPRN,OUTBAS,
	1		 OUTPUT,SPDO32,LTPH,LVSPI,
	1		 LVSPD,LVSPP,SPOUTI,SPOUTD,
	1		 SPOUTP,LVLHI,LVLLO,SPDHI,
	1		 SPDLO,CNTLSP,CRTLSP,LVLPRO,
	1		 SPDPRO,SPDS32,SPDN32,SPDL32,
	1		 SPDB32,OUT32I,OUT32D,OUT32P,
	1		 SP32LO,SP32HI
C
	EXTERNAL	AST_ROUTINE
C
	OPEN	(UNIT=6,FILE='SYS$COMMAND',STATUS='UNKNOWN')
C
	CLEAR(1:1)=CHAR(27)
	HOME(1:1)=CHAR(27)
	WRITE	(6,10)CLEAR
10	FORMAT	(' ',A)
C
	STAT=SMG$CREATE_PASTEBOARD(PBID,'SYS$COMMAND')
	STAT=SMG$CREATE_VIRTUAL_KEYBOARD(VKID,'SYS$COMMAND')
	STAT=SMG$ENABLE_UNSOLICITED_INPUT(PBID,AST_ROUTINE,
	1					VKID)
	IF (DO_NEXT)DO_NEXT=.FALSE.
C
100	CONTINUE
	WRITE	(6,110)HOME
110	FORMAT	(' ',A)
	DO 1000	I=1,2
		LINE=I+5
C
	WRITE	(6,120)LINE
120	FORMAT	(' GRATE & 32B LINE ',I1,' SETPNT','  VALUE',
	1	' OLDBAS',' OUTPUT')
	WRITE	(6,200)PRGLSP(I),LVLPRN(I),LVOBAS(I),LVLOUT(I)
200	FORMAT	(' GRATE BED LEVEL   ',4F7.2)
	WRITE	(6,210)SPDSET(I),SPDPRN(I),OUTBAS(I),OUTPUT(I)
210	FORMAT	(' GRATE SPEED       ',4F7.2)
	WRITE	(6,220)SPDS32(I),SPDN32(I),SPDB32(I),SPDO32(I)
220	FORMAT	(' 032 BELT SPEED    ',47F7.2)
	WRITE	(6,223)
223	FORMAT	('                                               ')
	WRITE	(6,225)CNTLSP(I)
225	FORMAT	(' CONTROLLER SETPNT ',F7.2)
	WRITE	(6,227)CRTLSP(I)
227	FORMAT	(' ALTERNATE  SETPNT ',F7.2)
	WRITE	(6,230)LTPH(I)
230	FORMAT	(' TONS AT GRATE     ',F7.2)
	WRITE	(6,240)CONTRL(I)
240	FORMAT	(' CONTROL WORD      ',O8)
	WRITE	(6,250)
250	FORMAT(' ..............................................')
1000	CONTINUE
	WRITE	(6,260)
260	FORMAT	(' TYPE S <RETURN> TO STOP DISPLAY')
C
	CALL	LIB$WAIT(SECONDS)
	GOTO 100
C
	END

